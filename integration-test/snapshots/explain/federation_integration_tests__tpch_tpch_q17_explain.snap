---
source: test/src/main.rs
description: Federated Query Explain
expression: plan_display
---
+---------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| plan_type     | plan                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
+---------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| logical_plan  | Federated                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |  Projection: sum(lineitem.l_extendedprice) / Float64(7) AS avg_yearly                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |   Aggregate: groupBy=[[]], aggr=[[sum(lineitem.l_extendedprice)]]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |     Inner Join:  Filter: part.p_partkey = lineitem.l_partkey                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |       Filter: lineitem.l_quantity < (<subquery>)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |         Subquery:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |           Projection: Float64(0.2) * avg(lineitem.l_quantity)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |             Aggregate: groupBy=[[]], aggr=[[avg(lineitem.l_quantity)]]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |               Filter: lineitem.l_partkey = outer_ref(part.p_partkey)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                 TableScan: lineitem                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |         TableScan: lineitem projection=[l_partkey, l_quantity, l_extendedprice]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |       TableScan: part projection=[p_partkey], full_filters=[part.p_brand = Utf8("Brand#23"), part.p_container = Utf8("MED BOX")]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| physical_plan | SchemaCastScanExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |   VirtualExecutionPlan name=duckdb compute_context=/Users/qianqian/datafusion-federation/tpch_sf1.db sql=SELECT (sum(lineitem.l_extendedprice) / 7.0) AS avg_yearly FROM lineitem JOIN "part" ON (("part".p_partkey = lineitem.l_partkey) AND (((lineitem.l_quantity < (SELECT (0.2 * avg(lineitem.l_quantity)) FROM lineitem WHERE (lineitem.l_partkey = "part".p_partkey))) AND ("part".p_brand = 'Brand#23')) AND ("part".p_container = 'MED BOX'))) rewritten_sql=SELECT (sum("lineitem"."l_extendedprice") // 7.0) AS "avg_yearly" FROM "lineitem" JOIN "part" ON (("part"."p_partkey" = "lineitem"."l_partkey") AND ((("lineitem"."l_quantity" < (SELECT (0.2 * avg("lineitem"."l_quantity")) FROM "lineitem" WHERE ("lineitem"."l_partkey" = "part"."p_partkey"))) AND ("part"."p_brand" = 'Brand#23')) AND ("part"."p_container" = 'MED BOX'))) |
|               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
+---------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
