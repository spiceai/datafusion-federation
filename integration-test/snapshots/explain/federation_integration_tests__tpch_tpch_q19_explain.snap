---
source: integration-test/src/main.rs
description: Federated Query Explain
expression: plan_display
---
+---------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| plan_type     | plan                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
+---------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| logical_plan  | Federated                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |  Projection: sum(lineitem.l_extendedprice * Int64(1) - lineitem.l_discount) AS revenue                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |   Aggregate: groupBy=[[]], aggr=[[sum(lineitem.l_extendedprice * (Int64(1) - lineitem.l_discount))]]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |     Inner Join:  Filter: part.p_partkey = lineitem.l_partkey AND part.p_brand = Utf8("Brand#12") AND part.p_container IN ([Utf8("SM CASE"), Utf8("SM BOX"), Utf8("SM PACK"), Utf8("SM PKG")]) AND lineitem.l_quantity >= Int64(1) AND lineitem.l_quantity <= Int64(1) + Int64(10) AND part.p_size BETWEEN Int64(1) AND Int64(5) AND lineitem.l_shipmode IN ([Utf8("AIR"), Utf8("AIR REG")]) AND lineitem.l_shipinstruct = Utf8("DELIVER IN PERSON") OR part.p_partkey = lineitem.l_partkey AND part.p_brand = Utf8("Brand#23") AND part.p_container IN ([Utf8("MED BAG"), Utf8("MED BOX"), Utf8("MED PKG"), Utf8("MED PACK")]) AND lineitem.l_quantity >= Int64(10) AND lineitem.l_quantity <= Int64(10) + Int64(10) AND part.p_size BETWEEN Int64(1) AND Int64(10) AND lineitem.l_shipmode IN ([Utf8("AIR"), Utf8("AIR REG")]) AND lineitem.l_shipinstruct = Utf8("DELIVER IN PERSON") OR part.p_partkey = lineitem.l_partkey AND part.p_brand = Utf8("Brand#34") AND part.p_container IN ([Utf8("LG CASE"), Utf8("LG BOX"), Utf8("LG PACK"), Utf8("LG PKG")]) AND lineitem.l_quantity >= Int64(20) AND lineitem.l_quantity <= Int64(20) + Int64(10) AND part.p_size BETWEEN Int64(1) AND Int64(15) AND lineitem.l_shipmode IN ([Utf8("AIR"), Utf8("AIR REG")]) AND lineitem.l_shipinstruct = Utf8("DELIVER IN PERSON")                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |       TableScan: lineitem projection=[l_partkey, l_quantity, l_extendedprice, l_discount, l_shipinstruct, l_shipmode], full_filters=[lineitem.l_quantity >= Int64(1) AND lineitem.l_quantity <= Int64(1) + Int64(10) AND lineitem.l_shipmode IN ([Utf8("AIR"), Utf8("AIR REG")]) AND lineitem.l_shipinstruct = Utf8("DELIVER IN PERSON") OR lineitem.l_quantity >= Int64(10) AND lineitem.l_quantity <= Int64(10) + Int64(10) AND lineitem.l_shipmode IN ([Utf8("AIR"), Utf8("AIR REG")]) AND lineitem.l_shipinstruct = Utf8("DELIVER IN PERSON") OR lineitem.l_quantity >= Int64(20) AND lineitem.l_quantity <= Int64(20) + Int64(10) AND lineitem.l_shipmode IN ([Utf8("AIR"), Utf8("AIR REG")]) AND lineitem.l_shipinstruct = Utf8("DELIVER IN PERSON")]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |       Filter: part.p_brand = Utf8("Brand#12") AND part.p_container IN ([Utf8("SM CASE"), Utf8("SM BOX"), Utf8("SM PACK"), Utf8("SM PKG")]) AND part.p_size BETWEEN Int64(1) AND Int64(5) OR part.p_brand = Utf8("Brand#23") AND part.p_container IN ([Utf8("MED BAG"), Utf8("MED BOX"), Utf8("MED PKG"), Utf8("MED PACK")]) AND part.p_size BETWEEN Int64(1) AND Int64(10) OR part.p_brand = Utf8("Brand#34") AND part.p_container IN ([Utf8("LG CASE"), Utf8("LG BOX"), Utf8("LG PACK"), Utf8("LG PKG")]) AND part.p_size BETWEEN Int64(1) AND Int64(15)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |         TableScan: part projection=[p_partkey, p_brand, p_size, p_container]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| physical_plan | SchemaCastScanExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |   VirtualExecutionPlan name=duckdb compute_context=tpch_sf1.db sql=SELECT sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))) AS revenue FROM lineitem JOIN "part" ON ((((((((((("part".p_partkey = lineitem.l_partkey) AND ("part".p_brand = 'Brand#12')) AND "part".p_container IN ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')) AND (lineitem.l_quantity >= 1)) AND (lineitem.l_quantity <= (1 + 10))) AND ("part".p_size BETWEEN 1 AND 5)) AND lineitem.l_shipmode IN ('AIR', 'AIR REG')) AND (lineitem.l_shipinstruct = 'DELIVER IN PERSON')) OR (((((((("part".p_partkey = lineitem.l_partkey) AND ("part".p_brand = 'Brand#23')) AND "part".p_container IN ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')) AND (lineitem.l_quantity >= 10)) AND (lineitem.l_quantity <= (10 + 10))) AND ("part".p_size BETWEEN 1 AND 10)) AND lineitem.l_shipmode IN ('AIR', 'AIR REG')) AND (lineitem.l_shipinstruct = 'DELIVER IN PERSON'))) OR (((((((("part".p_partkey = lineitem.l_partkey) AND ("part".p_brand = 'Brand#34')) AND "part".p_container IN ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')) AND (lineitem.l_quantity >= 20)) AND (lineitem.l_quantity <= (20 + 10))) AND ("part".p_size BETWEEN 1 AND 15)) AND lineitem.l_shipmode IN ('AIR', 'AIR REG')) AND (lineitem.l_shipinstruct = 'DELIVER IN PERSON'))) AND (((((((lineitem.l_quantity >= 1) AND (lineitem.l_quantity <= (1 + 10))) AND lineitem.l_shipmode IN ('AIR', 'AIR REG')) AND (lineitem.l_shipinstruct = 'DELIVER IN PERSON')) OR ((((lineitem.l_quantity >= 10) AND (lineitem.l_quantity <= (10 + 10))) AND lineitem.l_shipmode IN ('AIR', 'AIR REG')) AND (lineitem.l_shipinstruct = 'DELIVER IN PERSON'))) OR ((((lineitem.l_quantity >= 20) AND (lineitem.l_quantity <= (20 + 10))) AND lineitem.l_shipmode IN ('AIR', 'AIR REG')) AND (lineitem.l_shipinstruct = 'DELIVER IN PERSON'))) AND ((((("part".p_brand = 'Brand#12') AND "part".p_container IN ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')) AND ("part".p_size BETWEEN 1 AND 5)) OR ((("part".p_brand = 'Brand#23') AND "part".p_container IN ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')) AND ("part".p_size BETWEEN 1 AND 10))) OR ((("part".p_brand = 'Brand#34') AND "part".p_container IN ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')) AND ("part".p_size BETWEEN 1 AND 15))))) rewritten_sql=SELECT sum(("lineitem"."l_extendedprice" * (1 - "lineitem"."l_discount"))) AS "revenue" FROM "lineitem" JOIN "part" ON ((((((((((("part"."p_partkey" = "lineitem"."l_partkey") AND ("part"."p_brand" = 'Brand#12')) AND "part"."p_container" IN ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')) AND ("lineitem"."l_quantity" >= 1)) AND ("lineitem"."l_quantity" <= (1 + 10))) AND ("part"."p_size" BETWEEN 1 AND 5)) AND "lineitem"."l_shipmode" IN ('AIR', 'AIR REG')) AND ("lineitem"."l_shipinstruct" = 'DELIVER IN PERSON')) OR (((((((("part"."p_partkey" = "lineitem"."l_partkey") AND ("part"."p_brand" = 'Brand#23')) AND "part"."p_container" IN ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')) AND ("lineitem"."l_quantity" >= 10)) AND ("lineitem"."l_quantity" <= (10 + 10))) AND ("part"."p_size" BETWEEN 1 AND 10)) AND "lineitem"."l_shipmode" IN ('AIR', 'AIR REG')) AND ("lineitem"."l_shipinstruct" = 'DELIVER IN PERSON'))) OR (((((((("part"."p_partkey" = "lineitem"."l_partkey") AND ("part"."p_brand" = 'Brand#34')) AND "part"."p_container" IN ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')) AND ("lineitem"."l_quantity" >= 20)) AND ("lineitem"."l_quantity" <= (20 + 10))) AND ("part"."p_size" BETWEEN 1 AND 15)) AND "lineitem"."l_shipmode" IN ('AIR', 'AIR REG')) AND ("lineitem"."l_shipinstruct" = 'DELIVER IN PERSON'))) AND ((((((("lineitem"."l_quantity" >= 1) AND ("lineitem"."l_quantity" <= (1 + 10))) AND "lineitem"."l_shipmode" IN ('AIR', 'AIR REG')) AND ("lineitem"."l_shipinstruct" = 'DELIVER IN PERSON')) OR (((("lineitem"."l_quantity" >= 10) AND ("lineitem"."l_quantity" <= (10 + 10))) AND "lineitem"."l_shipmode" IN ('AIR', 'AIR REG')) AND ("lineitem"."l_shipinstruct" = 'DELIVER IN PERSON'))) OR (((("lineitem"."l_quantity" >= 20) AND ("lineitem"."l_quantity" <= (20 + 10))) AND "lineitem"."l_shipmode" IN ('AIR', 'AIR REG')) AND ("lineitem"."l_shipinstruct" = 'DELIVER IN PERSON'))) AND ((((("part"."p_brand" = 'Brand#12') AND "part"."p_container" IN ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')) AND ("part"."p_size" BETWEEN 1 AND 5)) OR ((("part"."p_brand" = 'Brand#23') AND "part"."p_container" IN ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')) AND ("part"."p_size" BETWEEN 1 AND 10))) OR ((("part"."p_brand" = 'Brand#34') AND "part"."p_container" IN ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')) AND ("part"."p_size" BETWEEN 1 AND 15))))) |
|               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
+---------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
