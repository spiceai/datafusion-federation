---
source: integration-test/src/main.rs
description: Federated Query Explain
expression: plan_display.clone()
---
+---------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| plan_type     | plan                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
+---------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| logical_plan  | Federated                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |  Sort: supplier_cnt DESC NULLS FIRST, part.p_brand ASC NULLS LAST, part.p_type ASC NULLS LAST, part.p_size ASC NULLS LAST                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |   Projection: part.p_brand, part.p_type, part.p_size, count(DISTINCT partsupp.ps_suppkey) AS supplier_cnt                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |     Aggregate: groupBy=[[part.p_brand, part.p_type, part.p_size]], aggr=[[count(DISTINCT partsupp.ps_suppkey)]]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |       Inner Join:  Filter: part.p_partkey = partsupp.ps_partkey                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |         Filter: partsupp.ps_suppkey NOT IN (<subquery>)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |           Subquery:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |             Projection: supplier.s_suppkey                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |               TableScan: supplier, full_filters=[supplier.s_comment LIKE Utf8("%Customer%Complaints%")]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |           TableScan: partsupp projection=[ps_partkey, ps_suppkey]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |         TableScan: part projection=[p_partkey, p_brand, p_type, p_size], full_filters=[part.p_brand != Utf8("Brand#45"), part.p_type NOT LIKE Utf8("MEDIUM POLISHED%"), part.p_size IN ([Int64(49), Int64(14), Int64(23), Int64(45), Int64(19), Int64(3), Int64(36), Int64(9)])]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| physical_plan | SchemaCastScanExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |   VirtualExecutionPlan name=duckdb compute_context=tpch_sf1.db initial_sql=SELECT "part"."p_brand", "part"."p_type", "part"."p_size", count(DISTINCT "partsupp"."ps_suppkey") AS "supplier_cnt" FROM "partsupp" INNER JOIN "part" ON (("part"."p_partkey" = "partsupp"."ps_partkey") AND ((("partsupp"."ps_suppkey" NOT IN (SELECT "supplier"."s_suppkey" FROM "supplier" WHERE "supplier"."s_comment" LIKE '%Customer%Complaints%') AND ("part"."p_brand" <> 'Brand#45')) AND "part"."p_type" NOT LIKE 'MEDIUM POLISHED%') AND "part"."p_size" IN (49, 14, 23, 45, 19, 3, 36, 9))) GROUP BY "part"."p_brand", "part"."p_type", "part"."p_size" ORDER BY "supplier_cnt" DESC NULLS FIRST, "part"."p_brand" ASC NULLS LAST, "part"."p_type" ASC NULLS LAST, "part"."p_size" ASC NULLS LAST |
|               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
+---------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
