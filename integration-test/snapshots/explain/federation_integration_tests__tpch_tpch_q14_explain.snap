---
source: integration-test/src/main.rs
description: Federated Query Explain
expression: plan_display
---
+---------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| plan_type     | plan                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+---------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| logical_plan  | Federated                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |  Projection: Float64(100) * sum(CASE WHEN part.p_type LIKE Utf8("PROMO%") THEN lineitem.l_extendedprice * Int64(1) - lineitem.l_discount ELSE Int64(0) END) / sum(lineitem.l_extendedprice * Int64(1) - lineitem.l_discount) AS promo_revenue                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |   Aggregate: groupBy=[[]], aggr=[[sum(CASE WHEN part.p_type LIKE Utf8("PROMO%") THEN lineitem.l_extendedprice * (Int64(1) - lineitem.l_discount) ELSE Int64(0) END), sum(lineitem.l_extendedprice * (Int64(1) - lineitem.l_discount))]]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |     Inner Join:  Filter: lineitem.l_partkey = part.p_partkey                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |       Filter: lineitem.l_shipdate >= CAST(Utf8("1995-09-01") AS Date32) AND lineitem.l_shipdate < CAST(Utf8("1995-10-01") AS Date32)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |         TableScan: lineitem projection=[l_partkey, l_extendedprice, l_discount, l_shipdate]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |       TableScan: part projection=[p_partkey, p_type]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| physical_plan | SchemaCastScanExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |   VirtualExecutionPlan name=duckdb compute_context=tpch_sf1.db sql=SELECT ((100.0 * sum(CASE WHEN "part".p_type LIKE 'PROMO%' THEN (lineitem.l_extendedprice * (1 - lineitem.l_discount)) ELSE 0 END)) / sum((lineitem.l_extendedprice * (1 - lineitem.l_discount)))) AS promo_revenue FROM lineitem JOIN "part" ON ((lineitem.l_partkey = "part".p_partkey) AND ((lineitem.l_shipdate >= CAST('1995-09-01' AS DATE)) AND (lineitem.l_shipdate < CAST('1995-10-01' AS DATE)))) rewritten_sql=SELECT ((100.0 * sum(CASE WHEN "part"."p_type" LIKE 'PROMO%' THEN ("lineitem"."l_extendedprice" * (1 - "lineitem"."l_discount")) ELSE 0 END)) // sum(("lineitem"."l_extendedprice" * (1 - "lineitem"."l_discount")))) AS "promo_revenue" FROM "lineitem" JOIN "part" ON (("lineitem"."l_partkey" = "part"."p_partkey") AND (("lineitem"."l_shipdate" >= CAST('1995-09-01' AS DATE)) AND ("lineitem"."l_shipdate" < CAST('1995-10-01' AS DATE)))) |
|               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
+---------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
